const mapWidth=24,mapHeight=24,screenWidth=640,screenHeight=480,map=[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,2,2,2,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1],[1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,3,0,0,0,3,0,0,0,1],[1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,2,2,0,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,0,0,0,0,5,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]];var posX=22,posY=12,dirX=-1,dirY=0,planeX=0,planeY=.66,time=0,oldTime=0,config={type:Phaser.AUTO,width:screenWidth,height:screenHeight,scene:{preload:preload,create:create,update:update}},wKey={},aKey={},sKey={},dKey={},game=new Phaser.Game(config),graphics={};function preload(){upKey=this.input.keyboard.addKey("w"),aKey=this.input.keyboard.addKey("a"),sey=this.input.keyboard.addKey("s"),sKey=this.input.keyboard.addKey("d")}function create(){graphics=this.add.graphics()}function update(e,a){graphics.clear();for(var s=[],i=0;i<screenWidth;i++){var r=2*i/screenWidth-1,t=dirX+planeX*r,d=dirY=planeY*r,p=posX,n=posY,c=Math.abs(1/t),h=Math.abs(1/d),o=0,g=0,y=0,l=0,u=0,K=0;for(side=0,t<0?(u=-1,g=(posX-p)*c):(u=1,g=(p+1-posX)*c),d<0?(K=-1,y=(posY-n)*h):(K=1,y=(n+1-posY)*h);0==o;)g<y?(g+=c,p+=u,side=0):(y+=h,n+=K,side=1),map[p][n]>0&&(o=1);l=0==side?(p-posX+(1-u)/2)/t:(n-posY+(1-K)/2)/d;var b,f=screenHeight/l,m=-f/2+screenHeight/2,k=f/2+screenHeight/2;switch(m<0&&(m=0),k>=screenHeight&&(k=screenHeight-1),map[p][n]){case 1:b=16711680;break;case 2:b=65280;break;case 3:b=255;break;case 4:b=16777215;break;default:b=16776960}1==side&&(b/=2),s.push({color:b,line:new Phaser.Geom.Line(i,m,i,k)})}s.forEach(function(e){graphics.lineStyle(1,e.color),graphics.strokeLineShape(e.line)})}